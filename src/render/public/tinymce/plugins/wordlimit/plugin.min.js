(function(){"use strict";function u(){t.add("wordlimit",function(n){var t=n.getParam("wordlimit",{},"object");if(!t||!t.max)return!1;if(typeof t.wordlimitCallback!="function"&&(t.wordlimitCallback=function(t){var i=0;t.wordCount>t.maxCount&&(i=t.wordCount-t.maxCount);n.notificationManager.open({text:"最多只能输入"+t.maxCount+"个字"+(i>0?"，已超出"+i+"个字，超出部分无法保存":"。"),type:"error",timeout:3e3})}),!n.plugins.wordcount)return n.notificationManager.open({text:"请先在tinymce的plugins配置wordlimit之前加入wordcount插件",type:"error",timeout:3e3}),!1;n.on("init",function(){new r(n,t)})})}let n=tinymce.util.Tools.resolve("tinymce.util.Tools"),t=tinymce.util.Tools.resolve("tinymce.PluginManager"),i={spaces:!1,isInput:!1,wordlimitCallback:null};class r{constructor(t,r){this.editor=t;this.options=n.extend(i,r);var f=this,o=t.getContent(),e=t.plugins.wordcount,s=0,u=0;t.on("input paste undo redo Keyup ",function(n){var i=t.getContent()||n.content||"";u=f.options.spaces?e.body.getCharacterCount():e.body.getCharacterCountWithoutSpaces();u>f.options.max&&(s=u,f.options.isInput||(t.setContent(o),u=f.options.spaces?e.body.getCharacterCount():e.body.getCharacterCountWithoutSpaces()),t.getBody().blur(),f.options.wordlimitCallback({maxCount:f.options.max,wordCount:u,preCount:s,isPaste:n.type==="paste"||n.paste||!1,oldContent:o}));o=t.getContent()})}}u()})();
